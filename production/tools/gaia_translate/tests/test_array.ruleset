////////////////////////////////////////////////////
// Copyright (c) Gaia Platform Authors
//
// Use of this source code is governed by the MIT
// license that can be found in the LICENSE.txt file
// or at https://opensource.org/licenses/MIT.
////////////////////////////////////////////////////

#include <cstring>

int g_client_sales = 0;

ruleset test_array
{
    on_insert(client)
    {
        if (strcmp(client_name, "1") == 0)
        {
            g_client_sales = sales[0];
            sales[0] = sales[3];
            sales[1] = 2;
            sales[2] -= 3;
            -- sales[3];
            sales[4] --;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "2") == 0)
        {
            g_client_sales = client.sales[0];
            client.sales[0] = client.sales[2];
            client.sales[1] = 3;
            client.sales[2] += 5;
            client.sales[3] ++;
            ++client.sales[4];
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "3") == 0)
        {
            sales = {3, 4, 5};
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "4") == 0)
        {
            int test_array[3] = {1, 2, 3};
            sales = test_array;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "5") == 0)
        {
            g_client_sales = company->client.sales[0];
            company->client.sales[0] = company->client.sales[1];
            company->client.sales[1] = 3;
            company->client.sales[2] += 5;
            company->client.sales[3] ++;
            ++ company->client.sales[4];
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "6") == 0)
        {
            client.sales = {10, 11, 12};
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "7") == 0)
        {
            int test_array[3] = {7, 9, 4};
            client.sales = test_array;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "8") == 0)
        {
            client.sales = sales;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "9") == 0)
        {
            sales = sales;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "10") == 0)
        {
            sales = client.sales;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "11") == 0)
        {
            client.sales = client.sales;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "12") == 0)
        {
            sales = {};
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "13") == 0)
        {
            client.sales = {};
        }
    }

    on_insert(company)
    {
        if (strcmp(company_name, "c2") == 0)
        {
            g_client_sales = company->client.sales[0];
            company->client.sales[0] = company->client.sales[3];
            company->client.sales[1] = 3;
            company->client.sales[2] += 5;
            company->client.sales[3] ++;
            ++company->client.sales[4];
        }
    }

    on_insert(company)
    {
        if (strcmp(company_name, "c3") == 0)
        {
           company->client.sales = {6, 9, 8};
        }
    }

    on_insert(company)
    {
        if (strcmp(company_name, "c4") == 0)
        {
            int test_array[3] = {1, 5, 3};
            company->client.sales = test_array;
        }
    }

    on_update(company_name)
    {
        int test_array[4] = {1, 2, 3, 5};
        client.insert(client_name:"a");
        client.insert(sales:test_array);
        client.insert(sales:{4, 7, 8});
        client.insert(client_name:"b", sales:test_array);
        client.insert(client_name:"c", sales:{5, 7, 9});
        client.insert(sales:test_array, client_name:"d");
        client.insert(sales:{4, 7, 8}, client_name:"e");
        client.insert(sales:client.sales, client_name:"f");
        client.insert(sales:sales, client_name:"g");
        client.insert(sales:{period, period + 1, period++, ++period}, client_name:"h");
        client.insert(sales:{period, period + 1, period++, ++period}, period:period++, client_name:"i");
        client.insert(sales:{period, period + 1, period++, ++period}, period:++period, client_name:"j");
    }

    on_insert(company)
    {
        if (strcmp(company_name, "c5") == 0)
        {
            sales[period] = period++;
            sales[period++] = ++period;
            sales[period + 1] = period + 1;
            sales[period]++;
            ++sales[++period];
            g_client_sales = sales[++period];
        }
    }

    on_insert(company)
    {
        if (strcmp(company_name, "c6") == 0)
        {
            sales = {period, period + 1, ++period, 3};
            g_client_sales = period;
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "14") == 0)
        {
            g_client_sales = 0;
            for (auto sale : sales)
            {
                g_client_sales += sale;
            }
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "15") == 0)
        {
            g_client_sales = 0;
            for (auto sale : client.sales)
            {
                g_client_sales += sale;
            }
        }
    }

    on_insert(client)
    {
        if (strcmp(client_name, "16") == 0)
        {
            g_client_sales = 0;
            for (auto sale : company->client.sales)
            {
                g_client_sales += sale;
            }
        }
    }
}
