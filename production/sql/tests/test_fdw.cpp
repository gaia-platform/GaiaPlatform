/////////////////////////////////////////////
// Copyright (c) Gaia Platform LLC
// All rights reserved.
/////////////////////////////////////////////

#include "gtest/gtest.h"

#include "catalog.hpp"
#include "db_catalog_test_base.hpp"
#include "file.hpp"

using namespace std;

using namespace gaia::db;
using namespace gaia::catalog;
using namespace gaia::catalog::ddl;

class fdw_test : public db_catalog_test_base_t
{
protected:
    fdw_test()
        : db_catalog_test_base_t("airlines.ddl"){};

    static field_def_list_t airlines_table_fields;
    static field_def_list_t airports_table_fields;
    static field_def_list_t routes_table_fields;
};

TEST_F(fdw_test, airport)
{
    // Load the command string generated by the build.
    file_loader_t command_loader;
    command_loader.load_file_data("fdw_test_command.txt");

    char* command = reinterpret_cast<char*>(command_loader.get_data());

    cerr << "Command executed by test is:" << endl
         << command << endl;

    // Execute the command and validate its return value.
    int return_value = system(command);
    ASSERT_EQ(0, return_value);
}
